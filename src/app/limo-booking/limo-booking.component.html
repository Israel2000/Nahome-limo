<div class="hero text-center text-white d-flex align-items-center justify-content-center"
  style="background-color: #343a40; height: 300px;">
  <div>
    <h1 class="display-4 font-weight-bold">Welcome to <span class="highlight">Nahome Limo Services</span></h1>
    <p class="lead">Your Premium Transportation Choice</p>
  </div>
</div>

<div class="container my-5">
  <h2 class="text-center mb-4">Order Pick up and Drop off</h2>
  <form #bookingForm="ngForm" (ngSubmit)="onSubmit(bookingForm)" novalidate>

    <div class="form-group ">
      <label for="pickupLocation">Pickup Location</label>
      <input type="text" name="pickupLocation" id="pickupLocation" class="form-control" [(ngModel)]="pickupLocation"
        (input)="filterPickupLocations()" (change)="calculatePrice()" placeholder="Enter Your PickUp Location" />

      <ul *ngIf="filteredPickupLocations.length > 0" class="autocomplete-list">
        <li *ngFor="let picklocation of filteredPickupLocations" (click)="selectPickupLocation(picklocation)"
          class="autocomplete-item">
          {{ picklocation }}
        </li>
      </ul>
    </div>

    <label for="stopLocations">Stops (Optional)</label>

    <!-- Add Stop Button -->
    <button type="button" class="btn btn-secondary mt-2" (click)="addStop()">Add Stop</button>

    <!-- Dynamic Stop Input Fields -->
    <div *ngFor="let stop of stops; let i = index; trackBy: trackByIndex" class="input-group mt-2">
      <input type="text" class="form-control" [id]="'stopLocation' + i" [name]="'stopLocation' + i"
        [(ngModel)]="stops[i]" placeholder="Enter Stop Location" />

      <!-- Remove Stop Button -->
      <div class="input-group-append">
        <button type="button" class="btn btn-danger" (click)="removeStop(i)">Remove</button>
      </div>
    </div>

    <!-- Drop Off Location Dropdown -->
    <div class="form-row">

      <div class="form-group col-md-6">
        <label for="address">Address</label>
        <input type="text" placeholder="Enter Your Drop-Off Address" class="form-control" id="address" name="address"
          [(ngModel)]="address" required>
      </div>

      <div class="form-group col-md-6">
        <label for="dropoffLocation">Drop Off Location</label>
        <input type="text" name="dropoffLocation" id="dropoffLocation" class="form-control"
          [(ngModel)]="dropoffLocation" (input)="filterLocations()" (change)="calculatePrice()"
          placeholder="Enter Your Drop-Off Location" />

        <ul *ngIf="filteredLocations.length > 0" class="autocomplete-list">
          <li *ngFor="let location of filteredLocations" (click)="selectLocation(location)" class="autocomplete-item">
            {{ location }}
          </li>
        </ul>
      </div>
    </div>

    <!-- Date of Service and Pick Up Time -->
    <div class="form-row">
      <div class="form-group col-md-6">
        <label for="dateOfService">Date of Service</label>
        <input type="date" class="form-control" id="dateOfService" name="dateOfService" [(ngModel)]="dateOfService"
          required />
      </div>
      <div class="form-group col-md-6">
        <label for="pickupTime">Pick Up Time</label>
        <input type="time" class="form-control" id="pickupTime" name="pickupTime" [(ngModel)]="pickupTime" required />
      </div>
    </div>

    <!-- Passenger Name and Email -->
    <div class="form-row">
      <div class="form-group col-md-6">
        <label for="passengerName">Name of Passenger</label>
        <input type="text" class="form-control" id="passengerName" name="passengerName" [(ngModel)]="passengerName"
          placeholder="Enter passenger name" required />
      </div>
      <div class="form-group col-md-6">
        <label for="email">Email Address</label>
        <input type="email" class="form-control" id="email" name="email" [(ngModel)]="email"
          placeholder="Enter email address" required />
      </div>
    </div>

    <!-- Phone Number and Vehicle Type -->
    <div class="form-row">
      <div class="form-group col-md-6">
        <label for="phone">Phone Number</label>
        <input type="tel" class="form-control" id="phone" name="phone" [(ngModel)]="phone"
          placeholder="Enter phone number" required />
      </div>

      <div class="form-group col-md-6">
        <label for="vehicleType">Vehicle Type</label>
        <select id="vehicleType" class="form-control" name="vehicleType" ngModel required [(ngModel)]="vehicleType"
          (change)="calculatePrice()">
          <option value="" disabled selected>Select a vehicle type</option>
          <option value="Sedan">Sedan</option> <!-- Set value for each option -->
          <option value="SUV">SUV</option>
        </select>
      </div>
    </div>

    <div class="form-group">
      <!-- Round Trip Checkbox -->
      <div class="form-check">
        <input class="form-check-input" type="checkbox" id="roundTrip" name="roundTrip" [(ngModel)]="roundTrip" />
        <label class="form-check-label" for="roundTrip">Round Trip</label>
      </div>
      <div class="form-group">
        <!-- Show Two Date Fields for Round Trip -->
        <div *ngIf="roundTrip">
          <label for="firstDate">Date Of Service</label>
          <input type="date" id="firstDate" name="firstDate" class="form-control" [(ngModel)]="firstDate" />

          <label for="lastDate">PickUp Time</label>
          <input type="time" id="lastDate" name="lastDate" class="form-control" [(ngModel)]="lastDate" />
        </div>
      </div>
      <!-- ASAP Checkbox -->
      <div class="form-check">
        <input class="form-check-input" type="checkbox" id="asap" name="asap" [(ngModel)]="asap" />
        <label class="form-check-label" for="asap">ASAP</label>
      </div>
    </div>

    <!-- Message -->
    <div class="form-group">
      <label for="message">Message</label>
      <textarea class="form-control" id="message" name="message" [(ngModel)]="message" rows="3"
        placeholder="Enter additional details"></textarea>
    </div>

    <!-- Price Display -->
    <div class="form-group">
      <label for="price">Price</label>
      <input type="text" class="form-control" id="price" name="price" [value]="price" readonly />
    </div>
    <div class="form-group">
      <label for="totalPrice">Total Price (including toll)</label>
      <input type="number" class="form-control" id="totalPrice" [value]="totalPrice" readonly />
    </div>

    <!-- Submit button (Shown when form is invalid or before payment) -->
    <div class="text-center" *ngIf="!showPaypalButton">
      <button type="submit" class="btn btn-primary submitbtn" [disabled]="!bookingForm.valid">
        Submit
      </button>
    </div>

    <!-- PayPal Button Container (Shown when form is valid and ready for payment) -->
    <div class="d-grid justify-content-center" *ngIf="showPaypalButton">
      <div class="text-center pt-3">
        <div class="paypal-button" id="paypal-button-container"></div>
      </div>
    </div>

  </form>

  <!-- Popup Overlay -->
  <div id="popupOverlay" *ngIf="showPopup" class="popup-overlay"></div>

  <!-- Popup Overlay (Only visible when showPopup is true) -->
  <div class="popup-overlay" *ngIf="showPopup">
    <div class="popup-box">
      <p>Payment successful! Thank you for your booking.</p>
      <button class="btn btn-success" (click)="handleOkClick()">OK</button>
    </div>
  </div>
</div>